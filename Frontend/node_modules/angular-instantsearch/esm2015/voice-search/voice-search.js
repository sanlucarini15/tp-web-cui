/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Component, Input, Inject, forwardRef, NgZone, ContentChild, TemplateRef, } from '@angular/core';
import { connectVoiceSearch } from 'instantsearch.js/es/connectors';
import { BaseWidget } from '../base-widget';
import { NgAisInstantSearch } from '../instantsearch/instantsearch';
import { noop } from '../utils';
export class NgAisVoiceSearch extends BaseWidget {
    /**
     * @param {?} instantSearchParent
     * @param {?} zone
     */
    constructor(instantSearchParent, zone) {
        super('VoiceSearch');
        this.instantSearchParent = instantSearchParent;
        this.zone = zone;
        this.buttonTitle = 'Search by voice';
        this.disabledButtonTitle = 'Search by voice (not supported on this browser)';
        this.state = {
            isBrowserSupported: undefined,
            isListening: undefined,
            toggleListening: noop,
            voiceListeningState: {
                status: 'initial',
                transcript: '',
                isSpeechFinal: false,
                errorCode: undefined,
            },
            templateContext: {
                status: 'initial',
                errorCode: undefined,
                transcript: '',
                isSpeechFinal: false,
                isListening: false,
                isBrowserSupported: false,
            },
        };
        this.handleClick = (/**
         * @param {?} event
         * @return {?}
         */
        (event) => {
            ((/** @type {?} */ (event.currentTarget))).blur();
            this.state.toggleListening();
        });
        this.isNotAllowedError = (/**
         * @return {?}
         */
        () => this.state.voiceListeningState.status === 'error' &&
            this.state.voiceListeningState.errorCode === 'not-allowed');
        this.updateState = (/**
         * @param {?} state
         * @return {?}
         */
        (state) => {
            this.zone.run((/**
             * @return {?}
             */
            () => {
                this.state = Object.assign({}, state, { templateContext: {
                        status: state.voiceListeningState.status,
                        errorCode: state.voiceListeningState.errorCode,
                        transcript: state.voiceListeningState.transcript,
                        isSpeechFinal: state.voiceListeningState.isSpeechFinal,
                        isListening: state.isListening,
                        isBrowserSupported: state.isBrowserSupported,
                    } });
            }));
        });
    }
    /**
     * @return {?}
     */
    ngOnInit() {
        this.createWidget(connectVoiceSearch, {
            searchAsYouSpeak: this.searchAsYouSpeak,
        });
        super.ngOnInit();
    }
}
NgAisVoiceSearch.decorators = [
    { type: Component, args: [{
                selector: 'ais-voice-search',
                template: `
    <div [class]="cx()">
      <button
        type="button"
        [class]="cx('button')"
        [title]="state.isBrowserSupported ? buttonTitle : disabledButtonTitle"
        [disabled]="!state.isBrowserSupported"
        (click)="handleClick($event)"
      >
        <ng-container *ngTemplateOutlet="button ? button : defaultButton; context: state.templateContext"></ng-container>
      </button>
      <div [class]="cx('status')">
        <ng-container *ngTemplateOutlet="status ? status : defaultStatus; context: state.templateContext"></ng-container>
      </div>
    </div>

    <ng-template #defaultButton let-status="status" let-errorCode="errorCode" let-isListening="isListening">
      <svg
        xmlns='http://www.w3.org/2000/svg'
        width='16'
        height='16'
        viewBox='0 0 24 24'
        fill='none'
        stroke='currentColor'
        strokeWidth='2'
        strokeLinecap='round'
        strokeLinejoin='round'
      >
        <ng-container *ngIf="isNotAllowedError(); then errorSvgContent else normalSvgContent">
        </ng-container>
        <ng-template #errorSvgContent>
          <line x1="1" y1="1" x2="23" y2="23"></line>
          <path d="M9 9v3a3 3 0 0 0 5.12 2.12M15 9.34V4a3 3 0 0 0-5.94-.6"></path>
          <path d="M17 16.95A7 7 0 0 1 5 12v-2m14 0v2a7 7 0 0 1-.11 1.23"></path>
          <line x1="12" y1="19" x2="12" y2="23"></line>
          <line x1="8" y1="23" x2="16" y2="23"></line>
        </ng-template>
        <ng-template #normalSvgContent>
          <path
            d="M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z"
            [attr.fill]="isListening ? 'currentColor' : 'none'"
          ></path>
          <path d="M19 10v2a7 7 0 0 1-14 0v-2"></path>
          <line x1="12" y1="19" x2="12" y2="23"></line>
          <line x1="8" y1="23" x2="16" y2="23"></line>
        </ng-template>
      </svg>
    </ng-template>
    <ng-template #defaultStatus let-transcript="transcript">
      <p>{{transcript}}</p>
    </ng-template>
  `
            }] }
];
/** @nocollapse */
NgAisVoiceSearch.ctorParameters = () => [
    { type: undefined, decorators: [{ type: Inject, args: [forwardRef((/**
                     * @return {?}
                     */
                    () => NgAisInstantSearch)),] }] },
    { type: NgZone }
];
NgAisVoiceSearch.propDecorators = {
    button: [{ type: ContentChild, args: ['button',] }],
    status: [{ type: ContentChild, args: ['status',] }],
    searchAsYouSpeak: [{ type: Input }],
    buttonTitle: [{ type: Input }],
    disabledButtonTitle: [{ type: Input }]
};
if (false) {
    /** @type {?} */
    NgAisVoiceSearch.prototype.button;
    /** @type {?} */
    NgAisVoiceSearch.prototype.status;
    /** @type {?} */
    NgAisVoiceSearch.prototype.searchAsYouSpeak;
    /** @type {?} */
    NgAisVoiceSearch.prototype.buttonTitle;
    /** @type {?} */
    NgAisVoiceSearch.prototype.disabledButtonTitle;
    /** @type {?} */
    NgAisVoiceSearch.prototype.state;
    /** @type {?} */
    NgAisVoiceSearch.prototype.handleClick;
    /** @type {?} */
    NgAisVoiceSearch.prototype.isNotAllowedError;
    /** @type {?} */
    NgAisVoiceSearch.prototype.updateState;
    /** @type {?} */
    NgAisVoiceSearch.prototype.instantSearchParent;
    /**
     * @type {?}
     * @private
     */
    NgAisVoiceSearch.prototype.zone;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidm9pY2Utc2VhcmNoLmpzIiwic291cmNlUm9vdCI6Im5nOi8vYW5ndWxhci1pbnN0YW50c2VhcmNoLyIsInNvdXJjZXMiOlsidm9pY2Utc2VhcmNoL3ZvaWNlLXNlYXJjaC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7O0FBQUEsT0FBTyxFQUNMLFNBQVMsRUFDVCxLQUFLLEVBQ0wsTUFBTSxFQUNOLFVBQVUsRUFDVixNQUFNLEVBQ04sWUFBWSxFQUVaLFdBQVcsR0FFWixNQUFNLGVBQWUsQ0FBQztBQUV2QixPQUFPLEVBQUUsa0JBQWtCLEVBQUUsTUFBTSxnQ0FBZ0MsQ0FBQztBQUNwRSxPQUFPLEVBQUUsVUFBVSxFQUFFLE1BQU0sZ0JBQWdCLENBQUM7QUFDNUMsT0FBTyxFQUFFLGtCQUFrQixFQUFFLE1BQU0sZ0NBQWdDLENBQUM7QUFDcEUsT0FBTyxFQUFFLElBQUksRUFBRSxNQUFNLFVBQVUsQ0FBQztBQW1HaEMsTUFBTSxPQUFPLGdCQUFpQixTQUFRLFVBQVU7Ozs7O0lBOEI5QyxZQUVTLG1CQUF3QixFQUN2QixJQUFZO1FBRXBCLEtBQUssQ0FBQyxhQUFhLENBQUMsQ0FBQztRQUhkLHdCQUFtQixHQUFuQixtQkFBbUIsQ0FBSztRQUN2QixTQUFJLEdBQUosSUFBSSxDQUFRO1FBNUJOLGdCQUFXLEdBQVcsaUJBQWlCLENBQUM7UUFFakQsd0JBQW1CLEdBQ3hCLGlEQUFpRCxDQUFDO1FBRTdDLFVBQUssR0FBVTtZQUNwQixrQkFBa0IsRUFBRSxTQUFTO1lBQzdCLFdBQVcsRUFBRSxTQUFTO1lBQ3RCLGVBQWUsRUFBRSxJQUFJO1lBQ3JCLG1CQUFtQixFQUFFO2dCQUNuQixNQUFNLEVBQUUsU0FBUztnQkFDakIsVUFBVSxFQUFFLEVBQUU7Z0JBQ2QsYUFBYSxFQUFFLEtBQUs7Z0JBQ3BCLFNBQVMsRUFBRSxTQUFTO2FBQ3JCO1lBQ0QsZUFBZSxFQUFFO2dCQUNmLE1BQU0sRUFBRSxTQUFTO2dCQUNqQixTQUFTLEVBQUUsU0FBUztnQkFDcEIsVUFBVSxFQUFFLEVBQUU7Z0JBQ2QsYUFBYSxFQUFFLEtBQUs7Z0JBQ3BCLFdBQVcsRUFBRSxLQUFLO2dCQUNsQixrQkFBa0IsRUFBRSxLQUFLO2FBQzFCO1NBQ0YsQ0FBQztRQWlCSyxnQkFBVzs7OztRQUFHLENBQUMsS0FBaUIsRUFBUSxFQUFFO1lBQy9DLENBQUMsbUJBQUEsS0FBSyxDQUFDLGFBQWEsRUFBZSxDQUFDLENBQUMsSUFBSSxFQUFFLENBQUM7WUFDNUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxlQUFlLEVBQUUsQ0FBQztRQUMvQixDQUFDLEVBQUM7UUFFSyxzQkFBaUI7OztRQUFHLEdBQVksRUFBRSxDQUN2QyxJQUFJLENBQUMsS0FBSyxDQUFDLG1CQUFtQixDQUFDLE1BQU0sS0FBSyxPQUFPO1lBQ2pELElBQUksQ0FBQyxLQUFLLENBQUMsbUJBQW1CLENBQUMsU0FBUyxLQUFLLGFBQWEsRUFBQztRQUV0RCxnQkFBVzs7OztRQUFHLENBQUMsS0FBWSxFQUFRLEVBQUU7WUFDMUMsSUFBSSxDQUFDLElBQUksQ0FBQyxHQUFHOzs7WUFBQyxHQUFHLEVBQUU7Z0JBQ2pCLElBQUksQ0FBQyxLQUFLLHFCQUNMLEtBQUssSUFDUixlQUFlLEVBQUU7d0JBQ2YsTUFBTSxFQUFFLEtBQUssQ0FBQyxtQkFBbUIsQ0FBQyxNQUFNO3dCQUN4QyxTQUFTLEVBQUUsS0FBSyxDQUFDLG1CQUFtQixDQUFDLFNBQVM7d0JBQzlDLFVBQVUsRUFBRSxLQUFLLENBQUMsbUJBQW1CLENBQUMsVUFBVTt3QkFDaEQsYUFBYSxFQUFFLEtBQUssQ0FBQyxtQkFBbUIsQ0FBQyxhQUFhO3dCQUN0RCxXQUFXLEVBQUUsS0FBSyxDQUFDLFdBQVc7d0JBQzlCLGtCQUFrQixFQUFFLEtBQUssQ0FBQyxrQkFBa0I7cUJBQzdDLEdBQ0YsQ0FBQztZQUNKLENBQUMsRUFBQyxDQUFDO1FBQ0wsQ0FBQyxFQUFDO0lBaENGLENBQUM7Ozs7SUFFRCxRQUFRO1FBQ04sSUFBSSxDQUFDLFlBQVksQ0FBQyxrQkFBa0IsRUFBRTtZQUNwQyxnQkFBZ0IsRUFBRSxJQUFJLENBQUMsZ0JBQWdCO1NBQ3hDLENBQUMsQ0FBQztRQUNILEtBQUssQ0FBQyxRQUFRLEVBQUUsQ0FBQztJQUNuQixDQUFDOzs7WUFsR0YsU0FBUyxTQUFDO2dCQUNULFFBQVEsRUFBRSxrQkFBa0I7Z0JBQzVCLFFBQVEsRUFBRTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0dBbURUO2FBQ0Y7Ozs7NENBZ0NJLE1BQU0sU0FBQyxVQUFVOzs7b0JBQUMsR0FBRyxFQUFFLENBQUMsa0JBQWtCLEVBQUM7WUE1STlDLE1BQU07OztxQkE4R0wsWUFBWSxTQUFDLFFBQVE7cUJBQ3JCLFlBQVksU0FBQyxRQUFROytCQUVyQixLQUFLOzBCQUNMLEtBQUs7a0NBQ0wsS0FBSzs7OztJQUxOLGtDQUF3RDs7SUFDeEQsa0NBQXdEOztJQUV4RCw0Q0FBMkM7O0lBQzNDLHVDQUF3RDs7SUFDeEQsK0NBRW9EOztJQUVwRCxpQ0FrQkU7O0lBaUJGLHVDQUdFOztJQUVGLDZDQUU2RDs7SUFFN0QsdUNBY0U7O0lBckNBLCtDQUMrQjs7Ozs7SUFDL0IsZ0NBQW9CIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtcbiAgQ29tcG9uZW50LFxuICBJbnB1dCxcbiAgSW5qZWN0LFxuICBmb3J3YXJkUmVmLFxuICBOZ1pvbmUsXG4gIENvbnRlbnRDaGlsZCxcbiAgRWxlbWVudFJlZixcbiAgVGVtcGxhdGVSZWYsXG4gIE9uSW5pdCxcbn0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5cbmltcG9ydCB7IGNvbm5lY3RWb2ljZVNlYXJjaCB9IGZyb20gJ2luc3RhbnRzZWFyY2guanMvZXMvY29ubmVjdG9ycyc7XG5pbXBvcnQgeyBCYXNlV2lkZ2V0IH0gZnJvbSAnLi4vYmFzZS13aWRnZXQnO1xuaW1wb3J0IHsgTmdBaXNJbnN0YW50U2VhcmNoIH0gZnJvbSAnLi4vaW5zdGFudHNlYXJjaC9pbnN0YW50c2VhcmNoJztcbmltcG9ydCB7IG5vb3AgfSBmcm9tICcuLi91dGlscyc7XG5cbnR5cGUgU3RhdHVzID1cbiAgfCAnaW5pdGlhbCdcbiAgfCAnYXNraW5nUGVybWlzc2lvbidcbiAgfCAnd2FpdGluZydcbiAgfCAncmVjb2duaXppbmcnXG4gIHwgJ2ZpbmlzaGVkJ1xuICB8ICdlcnJvcic7XG5cbnR5cGUgRXJyb3JDb2RlID1cbiAgfCAnbm8tc3BlZWNoJ1xuICB8ICdhYm9ydGVkJ1xuICB8ICdhdWRpby1jYXB0dXJlJ1xuICB8ICduZXR3b3JrJ1xuICB8ICdub3QtYWxsb3dlZCdcbiAgfCAnc2VydmljZS1ub3QtYWxsb3dlZCdcbiAgfCAnYmFkLWdyYW1tYXInXG4gIHwgJ2xhbmd1YWdlLW5vdC1zdXBwb3J0ZWQnO1xuXG50eXBlIFRlbXBsYXRlQ29udGV4dCA9IHtcbiAgc3RhdHVzOiBTdGF0dXM7XG4gIHRyYW5zY3JpcHQ6IHN0cmluZztcbiAgaXNTcGVlY2hGaW5hbDogYm9vbGVhbjtcbiAgZXJyb3JDb2RlPzogRXJyb3JDb2RlO1xuICBpc0Jyb3dzZXJTdXBwb3J0ZWQ6IGJvb2xlYW47XG4gIGlzTGlzdGVuaW5nOiBib29sZWFuO1xufTtcblxudHlwZSBWb2ljZUxpc3RlbmluZ1N0YXRlID0ge1xuICBzdGF0dXM6IFN0YXR1cztcbiAgdHJhbnNjcmlwdDogc3RyaW5nO1xuICBpc1NwZWVjaEZpbmFsOiBib29sZWFuO1xuICBlcnJvckNvZGU/OiBFcnJvckNvZGU7XG59O1xuXG50eXBlIFN0YXRlID0ge1xuICBpc0Jyb3dzZXJTdXBwb3J0ZWQ6IGJvb2xlYW47XG4gIGlzTGlzdGVuaW5nOiBib29sZWFuO1xuICB0b2dnbGVMaXN0ZW5pbmc6ICgpID0+IHZvaWQ7XG4gIHZvaWNlTGlzdGVuaW5nU3RhdGU6IFZvaWNlTGlzdGVuaW5nU3RhdGU7XG4gIHRlbXBsYXRlQ29udGV4dDogVGVtcGxhdGVDb250ZXh0O1xufTtcblxuQENvbXBvbmVudCh7XG4gIHNlbGVjdG9yOiAnYWlzLXZvaWNlLXNlYXJjaCcsXG4gIHRlbXBsYXRlOiBgXG4gICAgPGRpdiBbY2xhc3NdPVwiY3goKVwiPlxuICAgICAgPGJ1dHRvblxuICAgICAgICB0eXBlPVwiYnV0dG9uXCJcbiAgICAgICAgW2NsYXNzXT1cImN4KCdidXR0b24nKVwiXG4gICAgICAgIFt0aXRsZV09XCJzdGF0ZS5pc0Jyb3dzZXJTdXBwb3J0ZWQgPyBidXR0b25UaXRsZSA6IGRpc2FibGVkQnV0dG9uVGl0bGVcIlxuICAgICAgICBbZGlzYWJsZWRdPVwiIXN0YXRlLmlzQnJvd3NlclN1cHBvcnRlZFwiXG4gICAgICAgIChjbGljayk9XCJoYW5kbGVDbGljaygkZXZlbnQpXCJcbiAgICAgID5cbiAgICAgICAgPG5nLWNvbnRhaW5lciAqbmdUZW1wbGF0ZU91dGxldD1cImJ1dHRvbiA/IGJ1dHRvbiA6IGRlZmF1bHRCdXR0b247IGNvbnRleHQ6IHN0YXRlLnRlbXBsYXRlQ29udGV4dFwiPjwvbmctY29udGFpbmVyPlxuICAgICAgPC9idXR0b24+XG4gICAgICA8ZGl2IFtjbGFzc109XCJjeCgnc3RhdHVzJylcIj5cbiAgICAgICAgPG5nLWNvbnRhaW5lciAqbmdUZW1wbGF0ZU91dGxldD1cInN0YXR1cyA/IHN0YXR1cyA6IGRlZmF1bHRTdGF0dXM7IGNvbnRleHQ6IHN0YXRlLnRlbXBsYXRlQ29udGV4dFwiPjwvbmctY29udGFpbmVyPlxuICAgICAgPC9kaXY+XG4gICAgPC9kaXY+XG5cbiAgICA8bmctdGVtcGxhdGUgI2RlZmF1bHRCdXR0b24gbGV0LXN0YXR1cz1cInN0YXR1c1wiIGxldC1lcnJvckNvZGU9XCJlcnJvckNvZGVcIiBsZXQtaXNMaXN0ZW5pbmc9XCJpc0xpc3RlbmluZ1wiPlxuICAgICAgPHN2Z1xuICAgICAgICB4bWxucz0naHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnXG4gICAgICAgIHdpZHRoPScxNidcbiAgICAgICAgaGVpZ2h0PScxNidcbiAgICAgICAgdmlld0JveD0nMCAwIDI0IDI0J1xuICAgICAgICBmaWxsPSdub25lJ1xuICAgICAgICBzdHJva2U9J2N1cnJlbnRDb2xvcidcbiAgICAgICAgc3Ryb2tlV2lkdGg9JzInXG4gICAgICAgIHN0cm9rZUxpbmVjYXA9J3JvdW5kJ1xuICAgICAgICBzdHJva2VMaW5lam9pbj0ncm91bmQnXG4gICAgICA+XG4gICAgICAgIDxuZy1jb250YWluZXIgKm5nSWY9XCJpc05vdEFsbG93ZWRFcnJvcigpOyB0aGVuIGVycm9yU3ZnQ29udGVudCBlbHNlIG5vcm1hbFN2Z0NvbnRlbnRcIj5cbiAgICAgICAgPC9uZy1jb250YWluZXI+XG4gICAgICAgIDxuZy10ZW1wbGF0ZSAjZXJyb3JTdmdDb250ZW50PlxuICAgICAgICAgIDxsaW5lIHgxPVwiMVwiIHkxPVwiMVwiIHgyPVwiMjNcIiB5Mj1cIjIzXCI+PC9saW5lPlxuICAgICAgICAgIDxwYXRoIGQ9XCJNOSA5djNhMyAzIDAgMCAwIDUuMTIgMi4xMk0xNSA5LjM0VjRhMyAzIDAgMCAwLTUuOTQtLjZcIj48L3BhdGg+XG4gICAgICAgICAgPHBhdGggZD1cIk0xNyAxNi45NUE3IDcgMCAwIDEgNSAxMnYtMm0xNCAwdjJhNyA3IDAgMCAxLS4xMSAxLjIzXCI+PC9wYXRoPlxuICAgICAgICAgIDxsaW5lIHgxPVwiMTJcIiB5MT1cIjE5XCIgeDI9XCIxMlwiIHkyPVwiMjNcIj48L2xpbmU+XG4gICAgICAgICAgPGxpbmUgeDE9XCI4XCIgeTE9XCIyM1wiIHgyPVwiMTZcIiB5Mj1cIjIzXCI+PC9saW5lPlxuICAgICAgICA8L25nLXRlbXBsYXRlPlxuICAgICAgICA8bmctdGVtcGxhdGUgI25vcm1hbFN2Z0NvbnRlbnQ+XG4gICAgICAgICAgPHBhdGhcbiAgICAgICAgICAgIGQ9XCJNMTIgMWEzIDMgMCAwIDAtMyAzdjhhMyAzIDAgMCAwIDYgMFY0YTMgMyAwIDAgMC0zLTN6XCJcbiAgICAgICAgICAgIFthdHRyLmZpbGxdPVwiaXNMaXN0ZW5pbmcgPyAnY3VycmVudENvbG9yJyA6ICdub25lJ1wiXG4gICAgICAgICAgPjwvcGF0aD5cbiAgICAgICAgICA8cGF0aCBkPVwiTTE5IDEwdjJhNyA3IDAgMCAxLTE0IDB2LTJcIj48L3BhdGg+XG4gICAgICAgICAgPGxpbmUgeDE9XCIxMlwiIHkxPVwiMTlcIiB4Mj1cIjEyXCIgeTI9XCIyM1wiPjwvbGluZT5cbiAgICAgICAgICA8bGluZSB4MT1cIjhcIiB5MT1cIjIzXCIgeDI9XCIxNlwiIHkyPVwiMjNcIj48L2xpbmU+XG4gICAgICAgIDwvbmctdGVtcGxhdGU+XG4gICAgICA8L3N2Zz5cbiAgICA8L25nLXRlbXBsYXRlPlxuICAgIDxuZy10ZW1wbGF0ZSAjZGVmYXVsdFN0YXR1cyBsZXQtdHJhbnNjcmlwdD1cInRyYW5zY3JpcHRcIj5cbiAgICAgIDxwPnt7dHJhbnNjcmlwdH19PC9wPlxuICAgIDwvbmctdGVtcGxhdGU+XG4gIGAsXG59KVxuZXhwb3J0IGNsYXNzIE5nQWlzVm9pY2VTZWFyY2ggZXh0ZW5kcyBCYXNlV2lkZ2V0IGltcGxlbWVudHMgT25Jbml0IHtcbiAgQENvbnRlbnRDaGlsZCgnYnV0dG9uJykgYnV0dG9uOiBUZW1wbGF0ZVJlZjxFbGVtZW50UmVmPjtcbiAgQENvbnRlbnRDaGlsZCgnc3RhdHVzJykgc3RhdHVzOiBUZW1wbGF0ZVJlZjxFbGVtZW50UmVmPjtcblxuICBASW5wdXQoKSBwdWJsaWMgc2VhcmNoQXNZb3VTcGVhaz86IGJvb2xlYW47XG4gIEBJbnB1dCgpIHB1YmxpYyBidXR0b25UaXRsZTogc3RyaW5nID0gJ1NlYXJjaCBieSB2b2ljZSc7XG4gIEBJbnB1dCgpXG4gIHB1YmxpYyBkaXNhYmxlZEJ1dHRvblRpdGxlOiBzdHJpbmcgPVxuICAgICdTZWFyY2ggYnkgdm9pY2UgKG5vdCBzdXBwb3J0ZWQgb24gdGhpcyBicm93c2VyKSc7XG5cbiAgcHVibGljIHN0YXRlOiBTdGF0ZSA9IHtcbiAgICBpc0Jyb3dzZXJTdXBwb3J0ZWQ6IHVuZGVmaW5lZCxcbiAgICBpc0xpc3RlbmluZzogdW5kZWZpbmVkLFxuICAgIHRvZ2dsZUxpc3RlbmluZzogbm9vcCxcbiAgICB2b2ljZUxpc3RlbmluZ1N0YXRlOiB7XG4gICAgICBzdGF0dXM6ICdpbml0aWFsJyxcbiAgICAgIHRyYW5zY3JpcHQ6ICcnLFxuICAgICAgaXNTcGVlY2hGaW5hbDogZmFsc2UsXG4gICAgICBlcnJvckNvZGU6IHVuZGVmaW5lZCxcbiAgICB9LFxuICAgIHRlbXBsYXRlQ29udGV4dDoge1xuICAgICAgc3RhdHVzOiAnaW5pdGlhbCcsXG4gICAgICBlcnJvckNvZGU6IHVuZGVmaW5lZCxcbiAgICAgIHRyYW5zY3JpcHQ6ICcnLFxuICAgICAgaXNTcGVlY2hGaW5hbDogZmFsc2UsXG4gICAgICBpc0xpc3RlbmluZzogZmFsc2UsXG4gICAgICBpc0Jyb3dzZXJTdXBwb3J0ZWQ6IGZhbHNlLFxuICAgIH0sXG4gIH07XG5cbiAgY29uc3RydWN0b3IoXG4gICAgQEluamVjdChmb3J3YXJkUmVmKCgpID0+IE5nQWlzSW5zdGFudFNlYXJjaCkpXG4gICAgcHVibGljIGluc3RhbnRTZWFyY2hQYXJlbnQ6IGFueSxcbiAgICBwcml2YXRlIHpvbmU6IE5nWm9uZVxuICApIHtcbiAgICBzdXBlcignVm9pY2VTZWFyY2gnKTtcbiAgfVxuXG4gIG5nT25Jbml0KCkge1xuICAgIHRoaXMuY3JlYXRlV2lkZ2V0KGNvbm5lY3RWb2ljZVNlYXJjaCwge1xuICAgICAgc2VhcmNoQXNZb3VTcGVhazogdGhpcy5zZWFyY2hBc1lvdVNwZWFrLFxuICAgIH0pO1xuICAgIHN1cGVyLm5nT25Jbml0KCk7XG4gIH1cblxuICBwdWJsaWMgaGFuZGxlQ2xpY2sgPSAoZXZlbnQ6IE1vdXNlRXZlbnQpOiB2b2lkID0+IHtcbiAgICAoZXZlbnQuY3VycmVudFRhcmdldCBhcyBIVE1MRWxlbWVudCkuYmx1cigpO1xuICAgIHRoaXMuc3RhdGUudG9nZ2xlTGlzdGVuaW5nKCk7XG4gIH07XG5cbiAgcHVibGljIGlzTm90QWxsb3dlZEVycm9yID0gKCk6IGJvb2xlYW4gPT5cbiAgICB0aGlzLnN0YXRlLnZvaWNlTGlzdGVuaW5nU3RhdGUuc3RhdHVzID09PSAnZXJyb3InICYmXG4gICAgdGhpcy5zdGF0ZS52b2ljZUxpc3RlbmluZ1N0YXRlLmVycm9yQ29kZSA9PT0gJ25vdC1hbGxvd2VkJztcblxuICBwdWJsaWMgdXBkYXRlU3RhdGUgPSAoc3RhdGU6IFN0YXRlKTogdm9pZCA9PiB7XG4gICAgdGhpcy56b25lLnJ1bigoKSA9PiB7XG4gICAgICB0aGlzLnN0YXRlID0ge1xuICAgICAgICAuLi5zdGF0ZSxcbiAgICAgICAgdGVtcGxhdGVDb250ZXh0OiB7XG4gICAgICAgICAgc3RhdHVzOiBzdGF0ZS52b2ljZUxpc3RlbmluZ1N0YXRlLnN0YXR1cyxcbiAgICAgICAgICBlcnJvckNvZGU6IHN0YXRlLnZvaWNlTGlzdGVuaW5nU3RhdGUuZXJyb3JDb2RlLFxuICAgICAgICAgIHRyYW5zY3JpcHQ6IHN0YXRlLnZvaWNlTGlzdGVuaW5nU3RhdGUudHJhbnNjcmlwdCxcbiAgICAgICAgICBpc1NwZWVjaEZpbmFsOiBzdGF0ZS52b2ljZUxpc3RlbmluZ1N0YXRlLmlzU3BlZWNoRmluYWwsXG4gICAgICAgICAgaXNMaXN0ZW5pbmc6IHN0YXRlLmlzTGlzdGVuaW5nLFxuICAgICAgICAgIGlzQnJvd3NlclN1cHBvcnRlZDogc3RhdGUuaXNCcm93c2VyU3VwcG9ydGVkLFxuICAgICAgICB9LFxuICAgICAgfTtcbiAgICB9KTtcbiAgfTtcbn1cbiJdfQ==